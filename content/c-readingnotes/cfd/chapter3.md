---
title: 第3章 偏微分方程的数学性质对CFD的影响
linktitle: 3 偏微分方程的数学性质对CFD的影响
toc: true
type: docs
date: "2019-08-06T00:00:00+01:00"
draft: false
math: true
menu:
  cfd:
    parent: 卷1 基本思想和方程
    weight: 3

weight: 2
---
# 3.1 引言
> 对于给定的偏微分方程, 除了仅仅找到它的解之外, 我们必须意识到这些解在`不同的条件下`可以有完全不同的数学性质. `同一个流动控制方程, 方程是同一个方程, 但它的解在不同的流动区域里是完全不同的`. 正是因为解的数学性质使他们变得不一样了.

**拟线性方程组:** 方程中高阶导数都是以线性的形式出现, 即它们单独出现, 所乘的系数也都是未知函数本身的函数, 方程中没有出现最高阶导数的乘积或者指数函数.

# 3.2 拟线性偏微分方程的分类
考虑如下拟线性方程组:
$$a_1\frac{\partial u}{\partial x} + b_1\frac{\partial u}{\partial y} + c_1\frac{\partial v}{\partial x} + d_1\frac{\partial v}{\partial y} = f_1 \tag{3-1a}$$
$$a_2\frac{\partial u}{\partial x} + b_2\frac{\partial u}{\partial y} + c_2\frac{\partial v}{\partial x} + d_2\frac{\partial v}{\partial y} = f_2 \tag{3-2a}$$

其中:

- $u$和$v$是未知数, 它们都是$x, y$的函数

- $a_1, a_2, b_1, b_2, c_1, c_2, d_1, d_2, f_1, f_2$这些系数`可以是`$x, y$和$u, v$的函数

- $u, v$是$x, y$的连续函数

  ![图3-2特征线](/img/pic3-2.png)

  考虑在$xy$平面上的任意一点, 如图3-2所示中的P点: 我们寻找通过这一点的某条曲线, 使得沿着这条曲线, u和v的导数是不确定的, 而且跨过这条曲线是, 这些导数还是不连续的.

  我们要找的这种特殊曲线称为**特征线**

  我们想到$u$和$v$是$x, y$的连续导数, 写出u和v的全微分:

  $$du = \frac{\partial u}{\partial x}dx + \frac{\partial u}{\partial y}dy\tag{3-2a}$$
  $$dv = \frac{\partial v}{\partial x}dx + \frac{\partial v}{\partial y}dy\tag{3-2b}$$
  
  方程(3-1)和(3-2)是关于4个未知量: $(\frac{\partial u}{\partial x},\frac{\partial u}{\partial y},\frac{\partial v}{\partial x},\frac{\partial v}{\partial y})$ 的4个线性方程组
  
写成矩阵的形式为:
  
$$
\left(\begin{array}{cccc}
a_1 & b_1 & c_1 & d_1 \cr 
a_2 & b_2 & c_2 & d_2 \cr 
\mathrm{d} x & \mathrm{d} y & 0 & 0 \cr 
0 & 0 & \mathrm{d} x & \mathrm{d} y
\end{array}\right)
\left(\begin{array}{l}
\partial u / \partial x \cr
\partial u / \partial y \cr
\partial v / \partial x \cr
\partial v / \partial y
\end{array}\right)=\left(\begin{array}{c}
f_1 \cr 
f_2 \cr
\mathrm{d} u \cr 
\mathrm{d} v
\end{array}\right)
\tag{3-3}
$$

系数矩阵:

$$
\left[A\right] = \left(\begin{array}{llll} a_1 & b_1 & c_1 & d_1 \cr a_2 & b_2 & c_2 & d_2 \cr \mathrm{d} x & \mathrm{d} y & 0 & 0 \cr 0 & 0 & \mathrm{d} x & \mathrm{d} y\end{array}\right)\tag{3-4}
$$
使用克莱默法则求解方程组中的$\frac{\partial u}{\partial x}$, 即将矩阵$[A]$的第1列换成方程组(3-3)右端的列向量, 所得矩阵记为$[B]$:

$$\left[B\right] = \left(\begin{array}{llll}f_1 & b_1 & c_1 & d_1 \cr f_2 & b_2 & c_2 & d_2 \cr \mathrm{d} u & \mathrm{d} y & 0 & 0 \cr \mathrm{d} v & 0 & \mathrm{d} x & \mathrm{d} y\end{array}\right)\tag{3-5}$$

克莱默法则给出的解为

$$\frac{\partial u}{\partial x} = \frac{|B|}{|A|}\tag{3-6}$$

# 3.4.1 双曲型方程

首先，我们考虑具有两个自变量$x，y$的双曲型方程。$xy$平面如图3-3所示。在该平面上给定一点P。由于我们处理的是*双曲型方程*，于是有*两条实特征曲线通过P点*，分别记为左行特征线和右行特征线。（术语“左行”和“右行”源于下面的概念。假设你将图3-3放在地板上，然后站到P点上，面对着$x$轴正向。你必须向左转头才能看见从你眼前离开的一条特征曲线，这就是左行特征线。同样，你必须向右转头才能看见从你眼前离开的另一条特征曲线，这就是右行特征线。）这些特征线的意义在于，P点的信息只能影响两条特征线之间的区域。在P点给一个小的扰动，比如，用针在P点戳一下，在图3-3的区域内的每一点都会感受到这种扰动。而且只有在区域1内的点上才能感受到这种扰动。在这种意义上，我们把区域Ⅰ称为P点的影响区域。现在设想通过P点反向延伸到y轴的两条特征线，这两条特征线在$y$轴上戳取的部分记为$ab$。这对双曲型方程的边界条件有必然的影响。假设在$y$轴$(x=0)$上给定了边界条件，未知函数$u、v在y$轴上就是已知的。于是方程可以从这个给定的边界出发，沿着$x$轴“向前推进”求解。然而，如图3-3所示，P点处$u、v$的值仅依赖于边界上$a、b$之间的部分。图中的$c$点位于$ab$的范围之外，该点处的信息可以沿着从$c$点出发的两条特征线传播，并且只影响这两条特征线所围成的区域Ⅱ。但点P位于区域Ⅱ之外，所以不会感受到来自c点的信息。P点仅仅依赖于通过P点的两条反向特征线在边界上截取的部分（区间ab）。基于这样的原因，我们将图3-3中P点左边的区域Ⅰ，称为P点的依赖区域。也就是说，P点处的特性仅仅取决于区域Ⅱ中发生的事情。
用CFD的术语讲，由双曲型方程决定的流场可以“推进”求解。计算从给定的初始条件（如图3-3中的y轴）开始，沿着x轴方向一步步推进，逐步求解流场。
![](/img/pic3-3.png)

> 问题: 如果沿y方向推进求解, 图3-3上的"左行特征线"是不是就变成了所谓的"右行特征线"?

## 1. 定常无粘超声速流动
- t = 0
- $\mu = 0$
- $Ma > 0$ 
![](/img/pic3-4.png)
如果流动是二维的，则流动性质与图3-3中已经讨论过的一样。假设超声速流绕过二维圆弧翼型（图3-4），绕流可以有攻角$\alpha$，但是`攻角不能大到使前缘激波脱体，也不能产生局部亚声速流动`（*在定常流中，任何局部亚声速流动都是由椭圆型方程决定的*，原来用于求解双曲型方程的那种向下游推进的过程，数学上成为不适定的。在这种情况下，计算程序通常会“爆掉"）。具体地讲，对于2.8.2小节中所写出的欧拉方程（方程（2-82）~方程（2-86）），如果当地马赫数（见例3-1）是超声速时，不论方程写成守恒形式还是非守恒形式，定常流动的方程都属于双曲型。（更直观的例子是方程（3-20），它是在无旋小扰动的特殊条件下从欧拉方程导出来的。我们在3.3节中已经证明：当$Ma_{\infty}>1$时该方程是双曲型的。对定常流动欧拉方程组的特征值更一般性的分析表明，在当地马赫数大于1的地方，该方程组也是双曲型的。）在图34中，流动被认为处处是超声速的，整个流场由双曲型方程控制，主流方向是x方向。于是这个流场可以这样计算：在某个位置上给定初值，从初值开始沿着x方向逐步向下游推进，数值求解控制方程。计算中采用激波捕捉法还是激波装配法，将影响初值线位置的选取（回忆一下2.10节对激波捕捉法和激波装配法的讨论）。如果采用激波捕捉法，物体上游的ab线可以作为初值线，此时初值就是沿ab给定的自由来流。如果采用激波装配法，紧靠机翼前顶点下游的cd线和ef线（从物体表面延伸到激波）可以作为初值线。在这种情况下，通常采用经典的楔面斜激波的解来确定沿着cd和ef线的初值，楔角等于机翼前顶点相对于自由来流的角度。这种解沿着cd给出一组常数，沿ef线给出另一组常数。图3-4中剩下的流场可以从这些初值线开始，向下游推进求本书第3部分讨论实际应用时，我们将对这些问题做更清楚的说明。
![](/pic3-5.png)

为将上面的讨论推广到三维定常超声速无粘流动，对图3-5进行考查在三维的xyz空间中，特征曲线将变成特征曲面（图3-5）。给定P点的坐标x、y、z。该点处的信息将会影响向前的特征面所包含的阴影区域。如果$yz$平面是初值面，那么只有向后的特征面在yz平面截取的区域（用交叉线表示）内的初值才能对P点有影响。在图3-5中，对未知函数，可以从yz平面内给定的初值开始，沿着x方向推进求解。对于无粘超声速流动问题，通常取流动的方向作为x方向。

## 2 非定常无粘流动
![](/img/pic3-6.png)
让我们再次审视2.8.2小节中提到的欧拉方程。如果时间导数不等于零，就是非定常流动的情形，那么不论流动是局部亚声速的还是局部超声速的，控制方程都是双曲型方程。严格地讲，这种流动对时间是双曲型的（在11.2.1小节中将导出对时间为双曲型的方程）。这意味着在这种非定常流动中，无论空间是一维、二维还是三维的，推进的方向总是时间方向。让我们对此做进一步的讨论。对于一维非定常流动，设P点位于xt平面上（图3-6）。受P点影响的区域是通过P点向前的两条特征线之间的阴影区域。x轴（t-0）是初值线，但P点的解仅依赖于初值线（x轴）上的区间ab。将这种思想扩展到二维非定常流动，设P点位于xyt空间（图3-7）。图中显示了受P点影响的区域以及P点的解所依赖的xy平面内的区域。从xy平面内已知的初值开始，流场可以沿着时间向前推进求解。事实上，推广到三维非定常流动时，虽然难以用图形表示四个自变量的情形，但方式是一样的。三维非定常流动将用到2.8.2小节中给出的三维欧拉方程，但依然是沿时间方向向前推进。
![](/img/pic3-7.png)
我们在什么情况下会遇到非定常无粘流动呢？一个经典的例子是一维管道内波的运动。此时我们感兴趣的是瞬态变化。另一个例子是绕过振荡翼型的二维非定常流动。然而在CFD中，非定常时间推进法最大的用途是通过长时间的推进最终得到定常流动的解，前提是边界条件不随时间变化。时间推进在这里只是得到定常流场的种方法，最终的结果是定常流场。这样做看起来似乎缺乏效率。为什么在计算定常流场时却要引入时间作为额外的自变量呢？答案是：这是能够得到适定问题的惟一途径，因而也是惟一能够计算出定常解的方法。1.5节中超声速钝体问题的求解就属于这种情况。在本书的第3部分，我们还会看到更多采用这种方法的例子。

# 3.4.2 抛物型方程


# 常见流动分类

非常好

| 流动类型       | 控制方程 | 方程类型          | 求解方法           | 备注            |
|----------------|----------|-------------------|--------------------|-----------------|
| 无粘超声速流动 |          | 椭圆? 双曲? 抛物? | 特征线法(经典方法) | 粘性=0 马赫数>1 |

|                      |非定常      |定常 |
|----------------------|------------|--------|
|可压,粘性流动N-S方程组  |抛物-双曲型 |椭圆-双曲型|
|可压,无粘流动Euler方程组|双曲型      |亚声速:椭圆-抛物型\\超声速:双曲-抛物型|
|不可压,粘性流动N-S方程组|椭圆-抛物型 |椭圆型|
|可压,无粘流动Euler方程组|椭圆-双曲型  |椭圆-双曲型|

